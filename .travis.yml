language: c

sudo: required

compiler: gcc

install: make

before_script:
    - cp test-env/Line.pbt test-env/Line-old.pbt
    - touch empty-theme.cfg

script:
    - ./pbtheme -h
    
    - ./pbtheme test-env/Line.pbt theme.cfg
    - test -s theme.cfg
    - stat -c %s theme.cfg

    - ./pbtheme -p test-env/Line.pbt theme.cfg
    - test -s test-env/Line.pbt
    - stat -c %s test-env/Line-old.pbt test-env/Line.pbt
    
    - ./pbtheme -u test-env/Line.pbt > new-theme.cfg
    - test -s new-theme.cfg
    - stat -c %s new-theme.cfg theme.cfg
    - diff new-theme.cfg theme.cfg
    
    - ./pbtheme -p test-env/Line.pbt empty-theme.cfg
    - test -s test-env/Line.pbt
    - stat -c %s test-env/Line-old.pbt test-env/Line.pbt
    - cmp test-env/Line.pbt test-env/Line-old.pbt; test "$? = 1"
    - test "`stat -c %s test-env/Line.pbt`" -lt "`stat -c %s test-env/Line-old.pbt`"

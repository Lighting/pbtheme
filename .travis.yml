language: clang

compiler: gcc

env:
  - CROSS=
  - CROSS=pb
    before_install: git clone https://github.com/pocketbook-free/SDK_481.git
    cache: directories: $HOME/SDK_481

install: make

before_script:
    - touch empty-theme.cfg

script:
    - ./pbtheme -h
    
    - ./pbtheme test-env/Line.pbt theme.cfg
    - test "`stat -c %s theme.cfg`" = 227394

    - ./pbtheme -p test-env/Line.pbt theme.cfg
    - test "`stat -c %s test-env/Line.pbt`" = 520290

    - ./pbtheme -u test-env/Line.pbt > new-theme.cfg
    - diff new-theme.cfg theme.cfg
    
    - ./pbtheme -p test-env/Line.pbt empty-theme.cfg
    - test "`stat -c %s test-env/Line.pbt`" = 494527
